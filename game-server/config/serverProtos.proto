message Player {
    required string id          =   1;
}
message Role {
    required string id          =   1;
    required string name        =   2;
    required int32 level        =   3;
    optional int32 exp          =   4;
    optional string title       =   5;

    required int32 formation    =   13;
    repeated int32 formationLevel = 14;
    repeated string team        =   11;
    required int32 storageRoom  =   12;

    optional int32 energy       =   6;
    optional int32 coins        =   7;
    optional int32 golds        =   8;
    optional int32 contribs     =   9;

    optional int32 tutorial     =   10;
}
message Error {
    required int32 code         =   1;
    optional string message     =   2;
}
message Partition {
    required string id          =   1;
    required int32 status       =   2;
    required string name        =   3;
    required int32 openSince    =   4;
}
message ProfileChange {
    required int32 energyDiff   =   1;
    required int32 coinsDiff    =   2;
    required int32 goldsDiff    =   3;
    required int32 contribsDiff =   4;

    required int32 energy       =   5;
    required int32 coins        =   6;
    required int32 golds        =   7;
    required int32 contribs     =   8;
}
message ItemEffect {
    required string name  =   1;
    required int32 amount       =   2;
}
message ItemDef {
    required int32 id           =   1;
    required string name        =   2;
    required int32 quality      =   3;
    required string type        =   4;
    required string subType     =   5;
    required string resKey      =   6;
    required int32 levelReq     =   7;
    required int32 stackSize    =   8;
    required bool composable    =   9;
    required int32 composeCount =  10;
    repeated int32 composeTarget=  11;
    required bool canSell       =  12;
    required int32 price        =  13;
    required string desc        =  14;

    optional float hp           =  15;
    optional float attack       =  16;
    optional float magic        =  17;
    optional float defense      =  18;
    optional float resist       =  19;
    optional float attackSpeed  =  20;
    optional float critical     =  21;

    optional int32 useTarget    =  22;
    optional ItemEffect itemEffect = 23;
}
message EquipmentDef {
    required int32 id           =   1;
    required string name        =   2;
    required int32 color        =   3;
    required int32 quality      =   4;
    required string type        =   5;
    required string subType     =   6;
    required int32 levelReq     =   7;
    required string resKey      =   8;

    required int32 hp           =   9;
    required int32 attack       =   10;
    required int32 magic        =   11;
    required int32 defense      =   12;
    required int32 resist       =   13;

    required int32 hpGrowth     =   14;
    required int32 attackGrowth =   15;
    required int32 magicGrowth  =   16;
    required int32 defenseGrowth=   17;
    required int32 resistGrowth =   18;
    required int32 upgradeCost  =   19;

    required int32 hpRefine       = 20;
    required int32 attackRefine   = 21;
    required int32 magicRefine    = 22;
    required int32 defenseRefine  = 23;
    required int32 resistRefine   = 24;
    required int32 refineCost     = 26;

    required int32 slots          = 27;
    repeated string gemType       = 28;

    required int32 price          = 29;
}
message HeroDef {
    required int32 id           =   1;
    required string name        =   2;
    required string resKey      =   3;
    required string type        =   4;
    required int32 stars        =   5;
    required int32 quality      =   45;
    required int32 skill        =   6;
    required int32 pSkill       =   46;

    required int32 souls        =   7;

    required float vitality     =   8;
    required float strength     =   9;
    required float intelligence =   10;
    required int32 hp           =   11;
    required int32 hpGrowth     =   12;
    required int32 attack       =   13;
    required int32 attackGrowth =   14;
    required int32 magic        =   15;
    required int32 magicGrowth  =   16;
    required int32 defense      =   17;
    required int32 defenseGrowth=   18;
    required int32 resist       =   19;
    required int32 resistGrowth =   20;
    repeated float attackDelta  =   21;

    required float critical     =   22;
    required float interval     =   23;
    required float attackSpeed  =   24;
    required float speed        =   25;
    required int32 ballLev      =   26;
    required int32 secBallLev   =   27;

    repeated float hpRefine     =   32;
    repeated float attackRefine =   33;
    repeated float magicRefine  =   34;
    repeated float defenseRefine=   35;
    repeated float resistRefine =   36;
    repeated float refineStars  =   47;

    required float damage       =   37;
    required float damageReduction  =   38;
    required float damageFactor     =   39;
    required float damageRedFactor  =   40;
    required float physicalResist   =   41;
    required float magicResist      =   42;
    required float attackFactor     =   43;
    required float defenseFactor    =   44;
}
message Item {
    required string id          =   1;
    required int32 defId        =   2;
    required int32 level        =   3;
    required int32 refinement   =   4;
    optional string bound       =   6;
}
message Hero {
    required string id          =   1;
    required int32 defId        =   2;
    required int32 stars        =   3;
    required int32 level        =   4;
    required int32 exp          =   5;
}
message Task {
    required int32 id           =   1;
    required string name        =   2;
    required string description =   3;
    optional int32 start        =   4;
    optional int32 end          =   5;
    required int32 curProgress  =   6;
    required int32 needProgress =   7;
}
message ETypeWeight {
    required int32 type         =   1;
    required int32 seed         =   2;
}
message BarHero {
    required int32 id           =   1;
    required int32 contribs     =   2;
    required int32 golds        =   3;
}
message StoreItem {
    required int32 id           =   1;
    required string name        =   2;
    required bool gold          =   3;
    required int32 price        =   4;
    required int32 defId        =   5;
    required bool isSoul        =   6;
    required int32 count        =   7;
}
message Level {
    required int32 id           =   1;
    required string name        =   2;
    required string path        =   3;
    required int32 energy       =   4;
    required int32 exp          =   5;
}
message Stage {
    required int32 stageId      =   1;
    required string stage       =   2;
    repeated Level levels       =   3;
}

message connector_entryHandler_enter {
    optional Error error        =   1;
    optional Player user        =   2;
    repeated Partition partitions = 3;
}
message connector_entryHandler_enterPartition {
    optional Error error        =   1;
    optional Role role          =   2;
    repeated int32 heroCans     =   3;

    repeated ItemDef itemDefs   =   4;
    repeated EquipmentDef equipmentDefs = 5;
    repeated HeroDef heroDefs   =   6;

    repeated Item items         =   7;
    repeated Hero heroes        =   8;

    repeated Stage stages       =   9;

    optional sint32 nextGoldReset  =   10;
    optional sint32 nextCoinReset  =   11;
    optional int32 coinDrawCount   =   12;
}

message game_roleHandler_claimDailyReward {
    optional Error error        =   1;
    optional ProfileChange reward = 2;
}
message game_roleHandler_claimQuarterHourlyReward {
    optional Error error        =   1;
    optional ProfileChange reward = 2;
}

message game_itemHandler_listDef {
    optional Error error        =   1;
    repeated ItemDef items      =   2;
    repeated EquipmentDef equipments = 3;
}
message game_itemHandler_list {
    optional Error error        =   1;
    repeated Item items         =   2;
}
message game_itemHandler_listStore {
    optional Error error                    =   1;
    optional int32 nextCoinStoreRefresh     =   2;
    optional int32 nextGoldStoreRefresh     =   3;
    optional int32 coinPurchaseLeft         =   4;
    optional int32 goldPurchaseLeft         =   5;
    optional int32 coinRefreshLeft          =   6;
    optional int32 goldRefreshLeft          =   7;
    repeated StoreItem coinItems            =   8;
    repeated StoreItem goldItems            =   9;
}
message game_itemHandler_manualRefresh {
    optional Error error                    =   1;
    optional string destroyed               =   2;
    optional int32 coinRefreshLeft          =   3;
    optional int32 goldRefreshLeft          =   4;
    repeated StoreItem coinItems            =   5;
    repeated StoreItem goldItems            =   6;
}
message game_itemHandler_buy {
    optional Error error                    =   1;
    optional Role role                      =   2;
    repeated Item newItems                  =   3;
}
message game_itemHandler_refineGem {
    optional Error error        =   1;
    repeated string destroyed   =   2;
    optional Item gem           =   3;
}

message game_heroHandler_listDef {
    optional Error error        =   1;
    repeated HeroDef defs       =   2;
}
message game_heroHandler_queryDraw {
    optional Error error           =   1;
    optional sint32 nextGoldReset  =   2;
    optional sint32 nextCoinReset  =   3;
    optional int32   coinDrawCount =   4;
}
message game_heroHandler_list {
    optional Error error        =   1;
    repeated Hero heroes        =   2;
}
message game_heroHandler_equip {
    optional Error error        =   1;
    optional Item equipment     =   2;
}
message game_heroHandler_unEquip {
    optional Error error        =   1;
    optional Item equipment     =   2;
}

message game_equipmentHandler_setGem {
    optional Error error        =   1;
    optional Item gem           =   2;
}
message game_equipmentHandler_removeGem {
    optional Error error        =   1;
    optional Item gem           =   2;
}
message game_equipmentHandler_composite {
    optional Error error        =   1;
    repeated string destroyed   =   2;
    optional Item newItem       =   3;
}
message game_equipmentHandler_refine {
    optional Error error        =   1;
    optional string destroyed   =   2;
    optional Item equipment     =   3;
}
message game_equipmentHandler_upgrade {
    optional Error error        =   1;
    optional Item equipment     =   2;
    optional ProfileChange stateDiff = 3;
}
//message game_equipmentHandler_destructCheck {
//    optional Error error        =   1;
//    optional int32 coins        =   2;
//    optional int32 pieceId      =   3;
//    optional int32 pieceCount   =   4;
//    repeated string gems        =   5;
//}
//message game_equipmentHandler_destruct {
//    optional Error error                =   1;
//    optional ProfileChange stateDiff    =   2;
//    repeated Item newItems              =   3;
//    repeated string removeGems          =   4;
//}

message game_taskHandler_list {
    optional Error error        =   1;
    repeated Task tasks         =   2;
    repeated Task newTasks      =   3;
}
message game_taskHandler_claim {
    optional Error error        =   1;
    required int32 golds        =   2;
    required int32 coins        =   3;
    required int32 contribs     =   4;
    repeated Hero heroes        =   5;
    repeated Item items         =   6;
}

message game_levelHandler_list {
    optional Error error        =   1;
    repeated Stage stages       =   2;
}
message game_levelHandler_start {
    optional Error error            =   1;
    repeated ETypeWeight enemies    =   2;
}
message game_levelHandler_end {
    optional Error error        =   1;
    repeated Item newItems      =   2;
    optional Role role          =   3;
    optional int32 heroExp      =   4;
    optional int32 roleExp      =   5;
}
